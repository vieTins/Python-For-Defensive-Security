from collections import defaultdict

# Giả lập một lớp Exploit
class Exploit:
    def __init__(self, cve_id, name):
        self.cve_id = cve_id
        self.name = name

    def __repr__(self):
        return f"<Exploit {self.name}>"

# Danh sách các exploit giả lập
exploits = [
    Exploit("CVE-2024-1234", "exploit_A"),
    Exploit("CVE-2024-1234", "exploit_B"),
    Exploit("CVE-2023-9999", "exploit_C"),
    Exploit("CVE-2024-1234", "exploit_D"),
    Exploit("CVE-2023-8888", "exploit_E"),
]

# Tạo defaultdict với mỗi CVE-ID là một list các exploit
cve_map = defaultdict(list)

# Nhóm các exploit vào map
for exploit in exploits:
    cve_map[exploit.cve_id].append(exploit)

# In kết quả
for cve_id, exps in cve_map.items():
    print(f"{cve_id}:")
    for exp in exps:
        print(f"  - {exp}")     